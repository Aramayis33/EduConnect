<!DOCTYPE html>
<html lang="hy" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - ิณึีกีคีกึีกีถ</title>
  <link rel="stylesheet" href="/css/adminPageStyle.css"/>
  <link rel="stylesheet" href="/css/adminLibrary.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
</head>
<body>
<!-- Navigation -->
<nav class="nav">
  <div class="nav-header">
    <h1>EduConnect</h1>
    <span th:text="${session.admin.name} ?: 'ิฑีคีดีซีถ'"></span>
  </div>
  <ul>
    <li><a th:classappend="${activePage == 'home' ? 'active' : ''}" href="/admin/home">๐ ิณีฌีญีกีพีธึ</a></li>
    <li><a th:classappend="${activePage == 'students' ? 'active' : ''}" href="/admin/students">๐ ีึีฝีกีถีธีฒีถีฅึ</a></li>
    <li><a th:classappend="${activePage == 'teachers' ? 'active' : ''}" href="/admin/teachers">๐ฉโ๐ซ ิดีกีฝีกีญีธีฝีถีฅึ</a></li>
    <li><a th:classappend="${activePage == 'groups' ? 'active' : ''}" href="/admin/groups">๐งโ๐คโ๐ง ิฝีดีขีฅึ</a></li>
    <li><a th:classappend="${activePage == 'subjects' ? 'active' : ''}" href="/admin/subjects">๐ ิฑีผีกึีฏีกีถีฅึ</a></li>
    <li><a th:classappend="${activePage == 'schedule' ? 'active' : ''}" href="/admin/schedule">๐๏ธ ิดีกีฝีกึีธึึีกีฏ</a></li>
    <li><a th:classappend="${activePage == 'library' ? 'active' : ''}" href="/admin/library">๐ ิณึีกีคีกึีกีถ</a></li>
    <li><a th:classappend="${activePage == 'videos' ? 'active' : ''}" href="/admin/videos">๐ฅ ีีซีคีฅีธีคีกีฝีฅึ</a></li>
    <li><a th:classappend="${activePage == 'admins' ? 'active' : ''}" href="/admin/admins">๐๏ธ ิฑีคีดีซีถีถีฅึ</a></li>
    <li><a th:classappend="${activePage == 'events' ? 'active' : ''}" href="/admin/events">๐ ิปึีกีคีกึีฑีธึีฉีตีธึีถีถีฅึ</a></li>    <li><a href="/admin/logout" class="logout">๐ช ิตีฌึ</a></li>
  </ul>
</nav>

<!-- Main Content -->
<main class="content">
  <!-- Banner -->
  <section class="banner">
    <div class="banner-content">
      <div class="banner-title">
        <h2>๐ ิณึีกีคีกึีกีถ</h2>
        <span class="count-label">ิธีถีคีฐีกีถีธึึ ีฃึึีฅึี <strong th:text="${libraryList?.size()} ?: '0'"></strong></span>
      </div>
      <div class="banner-actions">
        <button class="banner-btn" id="add-book-btn"><i class="fas fa-plus"></i> ิฑีพีฅีฌีกึีถีฅีฌ ิณีซึึ</button>
      </div>
    </div>
    <div class="filters">
      <div class="filter-item">
        <label for="subject-filter">ิฑีผีกึีฏีก:</label>
        <select id="subject-filter">
          <option value="">ิธีถีฟึีฅึ ีกีผีกึีฏีกีถ</option>
          <th:block th:each="subject : ${subjectList}">
            <option th:value="${subject.name}" th:text="${subject.name}"></option>
          </th:block>
        </select>
      </div>
      <div class="filter-item">
        <label for="grade-filter">ิฟีธึึีฝ:</label>
        <select id="grade-filter">
          <option value="">ิธีถีฟึีฅึ ีฏีธึึีฝีจ</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
      </div>
    </div>
  </section>

  <!-- Library List -->
  <section class="library-list">
    <div id="no-results" class="no-results">
      <i id="search-icon" class="fas fa-search"></i>
      <p id="no-results-text">ิธีถีฟึีฅึ ีกีผีกึีฏีกีถ ึ ีฏีธึึีฝีจ ึีกีถีฏีกีฌีซ ีกึีคีตีธึีถึีจ ีฟีฅีฝีถีฅีฌีธึ ีฐีกีดีกึ</p>
    </div>

    <div id="library-list" class="library-grid">
      <div class="library-card" th:each="book : ${libraryList}"
           th:data-subject="${book.subject.name}"
           th:data-subject-id="${book.subject.id}"
           th:data-grade="${book.grade}">
        <div class="thumbnail-container">
          <img th:src="@{'/Uploads/'+${book.thumbnailImage}}"
               alt="ิณึึีซ ีดีกีถึีกีบีกีฟีฏีฅึ" class="thumbnail-image">
        </div>
        <div class="book-info">
          <h3 class="book-title" th:text="${book.title}"></h3>
          <div class="info-item">
            <span class="info-icon">๐</span>
            <p><strong>ิฑีผีกึีฏีก:</strong> <span th:text="${book.subject.name}"></span></p>
          </div>
          <div class="info-item">
            <span class="info-icon">๐</span>
            <p><strong>ิฟีธึึีฝ:</strong> <span th:text="${book.grade}"></span></p>
          </div>
          <div class="info-item">
            <span class="info-icon">โ๏ธ</span>
            <p><strong>ีีฅีฒีซีถีกีฏ:</strong> <span th:text="${book.bookAuthor}"></span></p>
          </div>
          <div class="info-item">
            <span class="info-icon">๐</span>
            <p><strong>ีึีกีฟ. ีฟีกึีซ:</strong> <span th:text="${book.bookPublicationYear}"></span></p>
          </div>
        </div>
        <div class="book-actions">
          <a th:href="@{'/Uploads/' + ${book.fileName}}" target="_blank" class="download-btn">
            <i class="fas fa-download"></i> ิดีซีฟีฅีฌ
          </a>
          <button class="edit-btn" th:attr="data-id=${book.id}"><i class="fas fa-edit"></i> ิฝีดีขีกีฃึีฅีฌ</button>
          <button class="delete-btn" th:attr="data-id=${book.id}"><i class="fas fa-trash"></i> ีีถีปีฅีฌ</button>
        </div>
      </div>
    </div>

    <div id="pagination" class="pagination">
      <button id="prev-page" class="page-btn"><i class="fas fa-chevron-left"></i> ีีกีญีธึีค</button>
      <div id="page-numbers" class="page-numbers"></div>
      <button id="next-page" class="page-btn">ีีกีปีธึีค <i class="fas fa-chevron-right"></i></button>
    </div>
  </section>

  <!-- Add/Edit Book Modal -->
  <div class="modal" id="add-book-modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h3 id="modal-title">ิฑีพีฅีฌีกึีถีฅีฌ ิณีซึึ</h3>
      <form id="book-form" th:action="@{/addBook}" method="post" enctype="multipart/form-data">
        <input type="hidden" id="book-id" name="id">
        <div class="form-group">
          <label for="book-title">ิณึึีซ ีีฅึีถีกีฃีซึ:</label>
          <input type="text" id="book-title" name="title" required>
        </div>
        <div class="form-group">
          <label for="book-subject">ิฑีผีกึีฏีก:</label>
          <select id="book-subject" name="subject" required>
            <option value="">ิธีถีฟึีฅึ ีกีผีกึีฏีก</option>
            <th:block th:each="subject : ${subjectList}">
              <option th:value="${subject.id}" th:text="${subject.name}"></option>
            </th:block>
          </select>
        </div>
        <div class="form-group">
          <label for="book-grade">ิฟีธึึีฝ:</label>
          <select id="book-grade" name="grade" required>
            <option value="">ิธีถีฟึีฅึ ีฏีธึึีฝ</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </div>
        <div class="form-group">
          <label for="book-author">ีีฅีฒีซีถีกีฏ:</label>
          <input type="text" id="book-author" name="bookAuthor" required>
        </div>
        <div class="form-group">
          <label for="book-year">ีึีกีฟีกึีกีฏีดีกีถ ีีกึีซ:</label>
          <input type="number" id="book-year" name="bookPublicationYear" min="1900" max="2025" required>
        </div>
        <div class="form-group">
          <label for="book-thumbnail">ีีกีถึีกีบีกีฟีฏีฅึ (ีถีฏีกึ):</label>
          <input type="file" id="book-thumbnail" name="thumbnailImage" accept="image/*">
          <span class="file-info" id="thumbnail-info"></span>
        </div>
        <div class="form-group">
          <label for="book-file">ิณึึีซ ีีกีตีฌ (PDF):</label>
          <input type="file" id="book-file" name="file" accept=".pdf">
          <span class="file-info" id="file-info"></span>
        </div>
        <div class="form-actions">
          <button type="submit" class="submit-btn"><i class="fas fa-save"></i> ีีกีฐีบีกีถีฅีฌ</button>
          <button type="button" class="cancel-btn"><i class="fas fa-times"></i> ีีฅีฒีกึีฏีฅีฌ</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal" id="delete-confirm-modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h3>ีีกีฝีฟีกีฟีฅีฌ ีีถีปีธึีดีจ</h3>
      <p>ีีฝีฟีกีีฐ ีฅึ, ีธึ ึีกีถีฏีกีถีธึีด ีฅึ ีปีถีปีฅีฌ ีกีตีฝ ีฃีซึึีจ:</p>
      <div class="form-actions">
        <button id="confirm-delete" class="submit-btn"><i class="fas fa-trash"></i> ีีถีปีฅีฌ</button>
        <button id="cancel-delete" class="cancel-btn"><i class="fas fa-times"></i> ีีฅีฒีกึีฏีฅีฌ</button>
      </div>
    </div>
  </div>
</main>

<script src="/js/adminLibrary.js"></script>
</body>
</html>