<!DOCTYPE html>
<html lang="hy" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‘ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥’∂’•÷Ä - EduConnect</title>
  <link rel="stylesheet" href="/css/studentCss.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="/css/studentsettings.css">
  <link rel="stylesheet" href="/css/teacherNotificationNavBar.css">
</head>
<body>
<!-- Header (Reused from Teacher Dashboard) -->
<header class="header" role="banner">
  <div class="logo" aria-label="EduConnect Logo">EduConnect</div>
  <!-- ‘æ’°’∂’∏÷Ç÷Å’∏÷Ç’¥’∂’•÷Ä’´ ’∂’∑’°’∂ ÷á dropdown -->
  <div class="notifications-container">
    <div class="notification-bell-wrapper">
      <i class="fas fa-bell notification-bell"></i>
      <span class="notification-count"
            th:text="${teacherNotifications?.size()} ?: '0'"
            th:style="${teacherNotifications?.size() == 0} ? 'display: none' : ''"></span>
    </div>
    <div class="notifications-dropdown">
      <div th:if="${teacherNotifications != null and !teacherNotifications.isEmpty()}">
        <div class="notification-item"
             th:each="notification : ${teacherNotifications}"
             th:data-notification-id="${notification.id}">
          <i class="fas notification-icon"
             th:classappend="${notification.messageType == 'admin'} ? 'fa-user-shield admin' : 'fa-cogs system'"></i>
          <div class="notification-content">
            <h4 th:text="${notification.messageTitle}"></h4>
            <p th:text="${notification.messageText.length() > 50 ? notification.messageText.substring(0, 50) + '...' : notification.messageText}"></p>
            <div class="notification-date"
                 th:text="${#dates.format(notification.date, 'dd.MM.yyyy HH:mm')}"></div>
          </div>
        </div>
        <a href="/teacher/notifications" class="view-all">’è’•’Ω’∂’•’¨ ’¢’∏’¨’∏÷Ä’®</a>
      </div>
      <div th:unless="${teacherNotifications != null and !teacherNotifications.isEmpty()}"
           class="no-notifications">
        ’Ü’∏÷Ä ’Æ’°’∂’∏÷Ç÷Å’∏÷Ç’¥’∂’•÷Ä ’π’Ø’°’∂
        <a href="/teacher/notifications" class="view-all">’è’•’Ω’∂’•’¨ ’¢’∏’¨’∏÷Ä’®</a>
      </div>
    </div>
  </div>
  <div class="profile" role="region" aria-label="User Profile">
    <div class="profile-pic-container">
      <img class="profile-pic"
           th:src="${session.teacher.image} != null ? @{/images/{image}(image=${session.teacher.image})} : @{/images/default.jpg}"
           alt="Profile Image"
           onerror="this.src='/images/default.jpg';"/>
      <div class="dropdown">
        <div class="dropdown-content" role="menu">
          <p th:text="'‘±’∂’∏÷Ç’∂: ' + ${session.teacher.name} + ' ' + ${session.teacher.surname}"></p>
          <p th:text="'‘±’º’°÷Ä’Ø’°: ' + ${session.teacherSubjects.get(0).name}"></p>
          <div class="dropdown-actions">
            <form action="/assistant" method="post">
              <button type="submit" class="profile-btn" aria-label="AI Assistant"><i
                      class="fas fa-robot"></i> AI ÷Ö’£’∂’°’Ø’°’∂
              </button>
            </form>
            <form action="/teacher/settings" method="post">
              <button type="submit" class="settings-btn" aria-label="Settings"><i class="fas fa-cog"></i>
                ‘ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥’∂’•÷Ä
              </button>
            </form>
            <form action="/logout-all" method="get">
              <button type="submit" class="logOut-btn" aria-label="Logout"><i
                      class="fas fa-sign-out-alt"></i> ‘µ’¨÷Ñ
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>
<main class="container">
  <section class="settings-container">
    <button class="back-btn" onclick="window.location.href='/teacher'">
      <i class="fas fa-arrow-left"></i> <span>’Ä’•’ø ‘≥’¨’≠’°’æ’∏÷Ä ‘∑’ª</span>
    </button>
    <h2>‘ø’°÷Ä’£’°’æ’∏÷Ä’∏÷Ç’¥’∂’•÷Ä</h2>

    <div class="settings-form">
      <!-- ’Ä’°’∑’æ’´ ’ø’æ’µ’°’¨’∂’•÷Ä -->
      <div class="form-section">
        <h3>’Ä’°’∑’æ’´ ’ø’æ’µ’°’¨’∂’•÷Ä</h3>
        <div class="form-group">
          <label>‘±’∂’∏÷Ç’∂:</label>
          <p th:text="${session.teacher.name}"></p>
        </div>
        <div class="form-group">
          <label>‘±’¶’£’°’∂’∏÷Ç’∂:</label>
          <p th:text="${session.teacher.surname}"></p>
        </div>
        <div class="form-group">
          <label>‘±’º’°÷Ä’Ø’°’∂’•÷Ä:</label>
          <div class="subjects-list">
            <th:block th:each="sub : ${session.teacherSubjects}">
              <span class="subject-tag" th:text="${sub.name}"></span>
            </th:block>
          </div>
        </div>
        <div class="form-group">
          <label>‘∑’¨. ÷É’∏’Ω’ø:</label>
          <p th:text="${session.teacher.email}"></p>
          <button type="button" class="edit-btn" id="edit-email-btn">’ì’∏’≠’•’¨ ’ß’¨. ÷É’∏’Ω’ø’®</button>
        </div>
        <div class="form-group hidden" id="email-change-section">
          <label for="new-email">’Ü’∏÷Ä ’ß’¨. ÷É’∏’Ω’ø:</label>
          <input type="email" id="new-email" name="newEmail">
          <button type="button" class="action-btn" id="send-verification-btn">’à÷Ç’≤’°÷Ä’Ø’•’¨ ’∞’°’Ω’ø’°’ø’¥’°’∂ ’Ø’∏’§</button>
          <div class="hidden" id="verification-section">
            <label for="verification-code">’Ä’°’Ω’ø’°’ø’¥’°’∂ ’Ø’∏’§:</label>
            <input type="text" id="verification-code" name="verificationCode">
            <button type="button" class="action-btn" id="verify-email-btn">’Ä’°’Ω’ø’°’ø’•’¨</button>
          </div>
        </div>

      </div>

      <!-- ‘≥’°’≤’ø’∂’°’¢’°’º’´ ÷É’∏÷É’∏’≠’∏÷Ç’©’µ’∏÷Ç’∂ -->
      <div class="form-section">
        <h3>‘≥’°’≤’ø’∂’°’¢’°’º</h3>
        <button type="button" class="edit-btn" id="change-password-btn">’ì’∏’≠’•’¨ ’£’°’≤’ø’∂’°’¢’°’º’®</button>
        <div class="form-group hidden" id="password-change-section">
          <label for="old-password">’Ä’´’∂ ’£’°’≤’ø’∂’°’¢’°’º:</label>
          <div class="password-container">
            <input type="password" id="old-password" name="oldPassword">
            <button type="button" class="toggle-password" id="toggle-old-password">üëÅÔ∏è</button>
          </div>
          <label for="new-password">’Ü’∏÷Ä ’£’°’≤’ø’∂’°’¢’°’º:</label>
          <div class="password-container">
            <input type="password" id="new-password" name="newPassword">
            <button type="button" class="toggle-password" id="toggle-new-password">üëÅÔ∏è</button>
          </div>
          <div class="password-requirements" id="password-requirements">
            <ul>
              <li id="req-length"><span class="icon"></span> ‘±’º’∂’æ’°’¶’∂ 8 ’∂’´’∑</li>
              <li id="req-uppercase"><span class="icon"></span> ’Ñ’•’Æ’°’ø’°’º (A-Z)</li>
              <li id="req-lowercase"><span class="icon"></span> ’ì’∏÷Ñ÷Ä’°’ø’°’º (a-z)</li>
              <li id="req-number"><span class="icon"></span> ‘π’´’æ (0-9)</li>
              <li id="req-symbol"><span class="icon"></span> ’Ä’°’ø’∏÷Ç’Ø ’Ω’´’¥’æ’∏’¨ (!@#$%^&*)</li>
            </ul>
          </div>
          <label for="confirm-password">’Ä’°’Ω’ø’°’ø’•’¨ ’∂’∏÷Ä ’£’°’≤’ø’∂’°’¢’°’º:</label>
          <div class="password-container">
            <input type="password" id="confirm-password" name="confirmPassword">
            <button type="button" class="toggle-password" id="toggle-confirm-password">üëÅÔ∏è</button>
          </div>
          <button type="button" class="action-btn" id="confirm-password-btn" disabled>’Ä’°’Ω’ø’°’ø’•’¨</button>
        </div>
      </div>

      <!-- ’ä÷Ä’∏÷Ü’´’¨’´ ’∂’Ø’°÷Ä -->
      <div class="form-section">
        <h3>’ä÷Ä’∏÷Ü’´’¨’´ ’∂’Ø’°÷Ä</h3>
        <div class="profile-image-container">
          <img id="image-preview" th:src="${session.teacher.image} != null ? @{/images/{image}(image=${session.teacher.image})} : @{/images/default.jpg}" alt="img">
          <button type="button" class="edit-image-btn" id="edit-image-btn"><i class="fas fa-pencil-alt"></i></button>
        </div>
        <div class="form-group hidden" id="image-edit-section">
          <input type="file" id="profile-image" name="profileImage" accept="image/*">
          <button type="button" class="action-btn" id="upload-image-btn">’Ä’°’Ω’ø’°’ø’•’¨</button>
          <button type="button" class="delete-btn" id="delete-image-btn">’ã’∂’ª’•’¨</button>
        </div>
      </div>
    </div>
  </section>
</main>
<div id="notification" class="notification hidden">
  <span id="notification-message"></span>
  <button id="close-notification">X</button>
</div>
<script src="/js/studentsettings.js"></script>
<script src="/js/teacherNotificationsBar.js"></script>
</body>
</html>