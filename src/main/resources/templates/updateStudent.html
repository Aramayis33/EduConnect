<!DOCTYPE html>
<html lang="hy" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>’à÷Ç’Ω’°’∂’∏’≤’´ ’¥’°’∂÷Ä’°’¥’°’Ω’∂’•÷Ä</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/updateStudent.css">
</head>
<body>
<div class="container">
  <!-- Header -->
  <header>
    <h1>EduAdmin - ’à÷Ç’Ω’°’∂’∏’≤’´ ’ø’æ’µ’°’¨’∂’•÷Ä</h1>
    <button class="back-btn" onclick="window.location.href='/admin/students'">‚Üê ’é’•÷Ä’°’§’°’º’∂’°’¨</button>
  </header>

  <!-- Profile Card -->
  <div class="profile-card">
    <div class="profile-image">
      <img th:src="'/images/'+${session.viewStudent.image} ?: '/images/default.jpg'" alt="’à÷Ç’Ω’°’∂’∏’≤’´ ’∂’Ø’°÷Ä">
    </div>
    <div class="profile-info">
      <h2 th:text="${session.viewStudent.name} + ' ' + ${session.viewStudent.surname}"></h2>
      <p><strong>‘Ω’∏÷Ç’¥’¢:</strong> <span th:text="${session.viewStudent.groupInfo?.groupNumber} ?: 'N/A'"></span></p>
      <p><strong>‘∑’¨. ÷É’∏’Ω’ø:</strong> <span th:text="${session.viewStudent.email}"></span></p>
      <p><strong>‘ø’°÷Ä’£’°’æ’´’≥’°’Ø:</strong> <span th:text="${session.viewStudent.isActivated == 1 ? '‘±’Ø’ø’´’æ’°÷Å’æ’°’Æ' : '’â’∑’°’∞’°’£’∏÷Ä’Æ’æ’∏’≤'}"></span></p>
      <p><strong>‘≤’¨’∏’Ø’°’æ’∏÷Ä’æ’°’Æ:</strong> <span th:text="${session.viewStudent.isBlocked == 0 ? '’à’π' : '‘±’µ’∏'}"></span></p>
      <p><strong>‘≤’°÷Å’°’Ø’°:</strong> <span th:text="${session.absentCount} +' ‘∫’°’¥'"></span></p>

      <button class="edit-btn" onclick="openEditModal()">‚úèÔ∏è ‘Ω’¥’¢’°’£÷Ä’•’¨</button>
      <button class="delete-btn" onclick="openDeleteModal()">üóëÔ∏è ’Ä’•’º’°÷Å’∂’•’¨</button>


    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('details')">’Ä’´’¥’∂’°’Ø’°’∂ ’ø’æ’µ’°’¨’∂’•÷Ä</button>
    <button class="tab-btn" onclick="showTab('loginHistory')">’Ñ’∏÷Ç’ø÷Ñ’•÷Ä’´ ’∫’°’ø’¥’∏÷Ç’©’µ’∏÷Ç’∂</button>
    <button class="tab-btn" onclick="showTab('summaryResults')">‘≥’∂’°’∞’°’ø’°’Ø’°’∂’∂’•÷Ä</button>
    <button class="tab-btn" onclick="showTab('feedbacks')">’Ä’•’ø’°’§’°÷Ä’± ’Ø’°’∫</button>
  </div>

  <!-- Tab Content -->
  <div id="details" class="tab-content active">
    <table class="details-table">
      <tr><th>‘±’∂’∏÷Ç’∂</th><td th:text="${session.viewStudent.name}"></td></tr>
      <tr><th>‘±’¶’£’°’∂’∏÷Ç’∂</th><td th:text="${session.viewStudent.surname}"></td></tr>
      <tr><th>‘æ’∂’∂’§’µ’°’∂ ’°’¥’Ω’°’©’´’æ</th><td th:text="${#dates.format(session.viewStudent.birthDay, 'yyyy-MM-dd')}"></td></tr>
      <tr><th>‘∑’¨. ÷É’∏’Ω’ø</th><td th:text="${session.viewStudent.email}"></td></tr>
      <tr><th>’é’°÷Ä’±’°’æ’≥’°÷Ä</th><td th:text="${session.viewStudent.fee}"></td></tr>
      <tr><th>‘Ω’∏÷Ç’¥’¢</th><td th:text="${session.viewStudent.groupInfo?.groupNumber} ?: 'N/A'"></td></tr>
    </table>
  </div>

  <div id="loginHistory" class="tab-content">
    <table class="details-table">
      <thead>
      <tr>
        <th>IP ’Ä’°’Ω÷Å’•</th>
        <th>’ç’°÷Ä÷Ñ’°’æ’∏÷Ä’∏÷Ç’¥</th>
        <th>’Ñ’∏÷Ç’ø÷Ñ’´ ’™’°’¥’°’∂’°’Ø</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="login : ${session.logInHistories}">
        <td th:text="${login.ipAddress}"></td>
        <td th:text="${login.userAgent}"></td>
        <td th:text="${#dates.format(login.loginTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeDeleteModal()">√ó</span>
      <h3>’Ä’°’Ω’ø’°’ø’•÷Ñ ’£’∏÷Ä’Æ’∏’≤’∏÷Ç’©’µ’∏÷Ç’∂’®</h3>
      <p>’Ä’°’¥’∏’¶’æ’°’Æ ’•’û÷Ñ, ’∏÷Ä ÷Å’°’∂’Ø’°’∂’∏÷Ç’¥ ’•÷Ñ ’∞’•’º’°÷Å’∂’•’¨ ’∏÷Ç’Ω’°’∂’∏’≤ <strong th:text="${session.viewStudent.name} + ' ' + ${session.viewStudent.surname}"></strong>-’´’∂ ’∞’°’¥’°’Ø’°÷Ä’£’´÷Å’ù ’∂’•÷Ä’°’º’µ’°’¨ ’∂÷Ä’° ’∞’•’ø ’°’º’∂’π’æ’∏’≤ ’∏’≤’ª ’ø’•’≤’•’Ø’°’ø’æ’∏÷Ç’©’µ’∏÷Ç’∂’® </p>
      <form id="deleteForm" action="/admin/students/delete" method="POST">
        <input type="hidden" name="id" th:value="${session.viewStudent.id}">
        <div class="modal-actions">
          <button type="button" class="cancel-btn" onclick="closeDeleteModal()">’â’•’≤’°÷Ä’Ø’•’¨</button>
          <button type="submit" class="confirm-delete-btn">’Ä’°’Ω’ø’°’ø’•’¨</button>
        </div>
      </form>
    </div>
  </div>

  <div id="summaryResults" class="tab-content">
    <table class="details-table">
      <thead>
      <tr>
        <th>‘±’º’°÷Ä’Ø’°</th>
        <th>‘Ω’∏÷Ç’¥’¢</th>
        <th>‘±’º’°’ª’´’∂ ’Ø’´’Ω’°’¥’µ’°’Ø</th>
        <th>‘µ÷Ä’Ø÷Ä’∏÷Ä’§ ’Ø’´’Ω’°’¥’µ’°’Ø</th>
        <th>‘∏’∂’§’∞’°’∂’∏÷Ç÷Ä</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="summary : ${session.summaryResults}">
        <td th:text="${summary.subject?.name} ?: 'N/A'"></td>
        <td th:text="${summary.group?.groupNumber} ?: 'N/A'"></td>
        <td th:text="${summary.firstSemester}"></td>
        <td th:text="${summary.secondSemester}"></td>
        <td th:text="${summary.afterAll}"></td>
      </tr>
      </tbody>
    </table>
  </div>

  <div id="feedbacks" class="tab-content">
    <table class="details-table">
      <thead>
      <tr>
        <th>‘±’¥’Ω’°’©’´’æ</th>
        <th>’Ñ’•’Ø’∂’°’¢’°’∂’∏÷Ç’©’µ’∏÷Ç’∂</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="feedback : ${session.feedbacks}">
        <td th:text="${#dates.format(feedback.date, 'yyyy-MM-dd')}"></td>
        <td th:text="${feedback.comment}"></td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit Modal -->
  <div id="editModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeEditModal()">√ó</span>
      <h3>‘Ω’¥’¢’°’£÷Ä’•’¨ ’∏÷Ç’Ω’°’∂’∏’≤’´ ’ø’æ’µ’°’¨’∂’•÷Ä’®</h3>
      <form id="editForm" onsubmit="updateStudent(event)">
        <input type="hidden" id="editId" name="id" th:value="${session.viewStudent.id}">
        <div class="form-group">
          <label for="editName">‘±’∂’∏÷Ç’∂</label>
          <input type="text" id="editName" name="name" th:value="${session.viewStudent.name}" required>
        </div>
        <div class="form-group">
          <label for="editSurname">‘±’¶’£’°’∂’∏÷Ç’∂</label>
          <input type="text" id="editSurname" name="surname" th:value="${session.viewStudent.surname}" required>
        </div>
        <div class="form-group">
          <label for="editBirthDay">‘æ’∂’∂’§’µ’°’∂ ’°’¥’Ω’°’©’´’æ</label>
          <input type="date" id="editBirthDay" name="birthDay" th:value="${#dates.format(session.viewStudent.birthDay, 'yyyy-MM-dd')}" required>
        </div>
        <div class="form-group">
          <label for="editEmail">‘∑’¨. ÷É’∏’Ω’ø</label>
          <input type="email" id="editEmail" name="email" th:value="${session.viewStudent.email}" required>
        </div>
        <div class="form-group">
          <label for="editFee">’é’°÷Ä’±’°’æ’≥’°÷Ä</label>
          <input type="number" id="editFee" name="fee" th:value="${session.viewStudent.fee}" required min="0">
        </div>
        <div class="form-group">
          <label for="editGroupId">‘Ω’∏÷Ç’¥’¢</label>
          <select id="editGroupId" name="groupId" required>
            <option value="">‘∏’∂’ø÷Ä’•÷Ñ ’≠’∏÷Ç’¥’¢</option>
            <option th:each="group : ${session.allGroups}"
                    th:value="${group.id}"
                    th:text="${group.groupNumber}"
                    th:selected="${group.id == session.viewStudent.groupInfo?.id}"></option>
          </select>
        </div>
        <button type="submit" class="submit-btn">’Ä’°’Ω’ø’°’ø’•’¨</button>
      </form>
    </div>
  </div>
</div>

<script src="/js/updateStudent.js"></script>
</body>
</html>